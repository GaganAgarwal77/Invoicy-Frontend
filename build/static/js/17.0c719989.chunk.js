(this.webpackJsonpinvoicy=this.webpackJsonpinvoicy||[]).push([[17],{348:function(e,t,c){"use strict";c.r(t);var s=c(23),a=c(2),n=c(85),i=c(11),l=c(12),r=c(13),d=c(14),o=c(71),j=c.n(o),h=c(0),x=c.n(h),u=c(161),m=c(127),b=c(155),O=c(162),p=c(102),f=c(125),v=c(99),y=c(26),N=c(103),k=c(349),g=c.n(k),w=c(105),I=c.n(w),C=c(73),A=c(3),B=[{key:"50% Advance",y:40,color:"#1ddec5"},{key:"100% Advance",y:30,color:"#1dcfda"},{key:"100% Postwork",y:30,color:"#20c997"}];function T(){for(var e=[],t=[],c=0;c<10;c++)e.push({x:c,y:parseInt(15*(.25*Math.sin(c/1.5)+.5))}),t.push({x:c,y:parseInt(3/Math.abs(Math.sin(c/20)+.5))});return[{values:e,key:"Invoices Raised",color:"#239f1c",area:!0},{values:t,key:"Pending Invoices",color:"#F45d55",area:!0}]}var S=function(e){Object(r.a)(c,e);var t=Object(d.a)(c);function c(e){var s;return Object(i.a)(this,c),(s=t.call(this,e)).state={companyId:window.localStorage.getItem("user_id"),clients:[],topInvoices:[],isBlockedClientsCollapsed:!1},s}return Object(l.a)(c,[{key:"getClients",value:function(){var e=Object(n.a)(j.a.mark((function e(){var t,c,i=this;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.state.companyId,e.prev=1,e.next=4,C.a.getAuth("/fetch-clients/",window.localStorage.getItem("token"));case 4:t=e.sent,c=t.data,console.log(c),c.forEach(function(){var e=Object(n.a)(j.a.mark((function e(t){var c,n,l,r,d,o,h;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t.client,e.next=3,C.a.getAuth("/users/id/".concat(c,"/"),window.localStorage.getItem("token"));case 3:return n=e.sent,l=n.data,console.log(l),e.next=8,C.a.getAuth("/client-invoice/".concat(c,"/"),window.localStorage.getItem("token"));case 8:r=e.sent,d=r.data,console.log(d),d.forEach((function(e){e=Object(a.a)(Object(a.a)({},e),{},{clientName:l.company_name,clientEmail:l.email}),i.setState({topInvoices:[].concat(Object(s.a)(i.state.topInvoices),[e])})})),o={clientId:t.client,blocked:t.blocked,discount:t.discount,name:l.company_name,numInvoices:d.length,email:l.email,username:l.username},h={id:t.client,data:o},i.setState({clients:[].concat(Object(s.a)(i.state.clients),[h])});case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.log(e.t0);case 13:case"end":return e.stop()}}),e,this,[[1,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.getClients()}},{key:"compareFilterTopInvoices",value:function(e,t){return e.dueAmount<t.dueAmount?1:e.dueAmount>t.dueAmount?-1:0}},{key:"filterTopInvoices",value:function(){var e=this.state.topInvoices;return e.sort(this.compareFilterTopInvoices),e.slice(0,5)}},{key:"viewDetails",value:function(e){this.props.history.push({pathname:"/view-invoice/",state:{invoice:e}})}},{key:"updateWorkStatus",value:function(){var e=Object(n.a)(j.a.mark((function e(t){var c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.a.patchAuth("/invoice/".concat(t,"/"),{workCompleted:"true",note:"some note"},window.localStorage.getItem("token"));case 2:c=e.sent,console.log(c),c?(this.dialog.showAlert("Success!"),window.location.reload()):this.dialog.showAlert("Something went wrong!");case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=[],c=[],s=[];return this.filterTopInvoices().forEach((function(c){t.push(Object(A.jsxs)("tr",{className:"unread",children:[Object(A.jsx)("td",{children:Object(A.jsx)("img",{className:"rounded-circle",style:{width:"40px"},src:N.a,alt:"activity-user"})}),Object(A.jsxs)("td",{children:[Object(A.jsx)("h6",{className:"mb-1",children:c.clientName}),Object(A.jsx)("p",{className:"m-0",children:c.clientEmail})]}),Object(A.jsx)("td",{children:Object(A.jsxs)("h6",{className:"text-muted",children:[Object(A.jsx)("i",{className:"fa fa-circle text-c-green f-10 m-r-15"}),c.invoiceDate]})}),Object(A.jsx)("td",{children:Object(A.jsxs)("h6",{className:"text-muted",children:[Object(A.jsx)("i",{className:"fa fa-circle text-c-red f-10 m-r-15"}),c.dueDate]})}),Object(A.jsx)("td",{children:Object(A.jsxs)("h6",{className:"text-muted",children:["Work Status: \xa0",c.workCompleted&&Object(A.jsx)("span",{className:"text-success",children:"Completed"}),!c.workCompleted&&Object(A.jsx)("span",{className:"text-danger",children:"Not Completed"})]})}),Object(A.jsx)("td",{children:Object(A.jsxs)("h6",{className:"text-muted",children:[c.dueAmount," INR due"]})}),Object(A.jsxs)("td",{children:[Object(A.jsx)("button",{style:{border:0},onClick:function(){return e.viewDetails(c)},className:"label theme-bg2 text-white f-12",children:"View Details"}),Object(A.jsxs)("button",{style:{border:0},onClick:function(){return e.updateWorkStatus(c.id)},className:"label theme-bg text-white f-12",children:[!c.workCompleted&&"Update Progress",c.workCompleted&&"Delete Progress"]}),Object(A.jsx)("button",{style:{border:0},onClick:function(){e.dialog.showAlert("Reminder sent!")},className:"label theme-bg text-white f-12",children:"Remind"}),Object(A.jsx)(I.a,{ref:function(t){e.dialog=t}})]})]},c.id))})),this.state.clients.forEach((function(e){e.data.blocked?s.push(Object(A.jsxs)("tr",{className:"unread",children:[Object(A.jsx)("td",{children:Object(A.jsx)("img",{className:"rounded-circle",style:{width:"40px"},src:N.a,alt:"activity-user"})}),Object(A.jsx)("td",{children:Object(A.jsx)("p",{className:"m-0",children:e.data.username})}),Object(A.jsx)("td",{children:Object(A.jsx)("p",{className:"m-0",children:e.data.company_name})}),Object(A.jsx)("td",{children:Object(A.jsx)("p",{className:"m-0",children:e.data.email})}),Object(A.jsx)("td",{children:Object(A.jsx)("p",{className:"m-0",children:e.data.discount})}),Object(A.jsx)("td",{children:Object(A.jsxs)("h6",{className:"text-muted",children:[e.data.numInvoices," Invoices"]})}),Object(A.jsx)("td",{children:Object(A.jsx)(v.a,{to:"/clients/"+e.data.clientId,className:"label theme-bg text-white f-12",children:"View Details"})})]},e.id)):c.push(Object(A.jsxs)("tr",{className:"unread",children:[Object(A.jsx)("td",{children:Object(A.jsx)("img",{className:"rounded-circle",style:{width:"40px"},src:N.a,alt:"activity-user"})}),Object(A.jsx)("td",{children:Object(A.jsx)("p",{className:"m-0",children:e.data.username})}),Object(A.jsx)("td",{children:Object(A.jsx)("p",{className:"m-0",children:e.data.company_name})}),Object(A.jsx)("td",{children:Object(A.jsx)("p",{className:"m-0",children:e.data.email})}),Object(A.jsx)("td",{children:Object(A.jsxs)("p",{className:"m-0",children:["Discount: ",e.data.discount,"%"]})}),Object(A.jsx)("td",{children:Object(A.jsxs)("h6",{className:"text-muted",children:[e.data.numInvoices," Invoices"]})}),Object(A.jsx)("td",{children:Object(A.jsx)(v.a,{to:"/clients/"+e.data.clientId,className:"label theme-bg text-white f-12",children:"View Details"})})]},e.id))})),Object(A.jsx)(y.a,{children:Object(A.jsxs)(u.a,{children:[Object(A.jsx)(m.a,{md:6,xl:4,children:Object(A.jsx)(b.a,{children:Object(A.jsxs)(b.a.Body,{children:[Object(A.jsx)("h6",{className:"mb-4",children:"Total Invoices Generated"}),Object(A.jsx)("div",{className:"row d-flex align-items-center",children:Object(A.jsx)("div",{className:"col-9",children:Object(A.jsxs)("h3",{className:"f-w-300 d-flex align-items-center m-b-0",children:[Object(A.jsx)("i",{className:"feather icon-file-text f-30 m-r-5"}),this.state.topInvoices.length]})})})]})})}),Object(A.jsx)(m.a,{md:6,xl:4,children:Object(A.jsx)(b.a,{children:Object(A.jsxs)(b.a.Body,{children:[Object(A.jsx)("h6",{className:"mb-4",children:"Total Pending Invoices"}),Object(A.jsx)("div",{className:"row d-flex align-items-center",children:Object(A.jsx)("div",{className:"col-9",children:Object(A.jsxs)("h3",{className:"f-w-300 d-flex align-items-center m-b-0",children:[Object(A.jsx)("i",{className:"feather icon-file-text text-c-red f-30 m-r-5"}),t.length]})})})]})})}),Object(A.jsx)(m.a,{xl:4,children:Object(A.jsx)(b.a,{children:Object(A.jsxs)(b.a.Body,{children:[Object(A.jsx)("h6",{className:"mb-4",children:"Total Clients"}),Object(A.jsx)("div",{className:"row d-flex align-items-center",children:Object(A.jsx)("div",{className:"col-9",children:Object(A.jsxs)("h3",{className:"f-w-300 d-flex align-items-center m-b-0",children:[Object(A.jsx)("i",{className:"feather icon-users f-30 m-r-5"})," ",this.state.clients.length]})})})]})})}),Object(A.jsx)(m.a,{md:6,xl:6,children:Object(A.jsxs)(b.a,{children:[Object(A.jsx)(b.a.Header,{children:Object(A.jsxs)(b.a.Title,{as:"h5",children:["Types of Invoices Raised ",Object(A.jsx)("small",{children:"Distribution"})]})}),Object(A.jsx)(b.a.Body,{className:"text-center",children:Object(A.jsx)(g.a,{id:"chart",height:300,type:"pieChart",datum:B,x:"key",y:"y"})})]})}),Object(A.jsx)(m.a,{md:6,xl:6,children:Object(A.jsxs)(b.a,{className:"Recent-Users",children:[Object(A.jsx)(b.a.Header,{children:Object(A.jsxs)(b.a.Title,{as:"h5",children:["Invoices Raised",Object(A.jsx)("small",{children:" [In last 10 days]"})]})}),Object(A.jsx)(b.a.Body,{className:"text-center",children:Object(A.jsx)("div",{children:x.a.createElement(g.a,{xAxis:{tickFormat:function(e){return e},axisLabel:"Time (days)"},yAxis:{axisLabel:"Invoices Count",tickFormat:function(e){return parseFloat(e).toFixed(2)}},type:"lineChart",datum:T(),x:"x",y:"y",height:300,renderEnd:function(){console.log("renderEnd")}})})})]})}),Object(A.jsx)(m.a,{md:12,xl:12,children:Object(A.jsxs)(b.a,{className:"Recent-Users",children:[Object(A.jsx)(b.a.Header,{children:Object(A.jsx)(b.a.Title,{as:"h5",children:"Most Important Invoices"})}),Object(A.jsx)(b.a.Body,{className:"px-0 py-2",children:Object(A.jsx)(O.a,{responsive:!0,hover:!0,children:Object(A.jsx)("tbody",{children:t})})})]})}),Object(A.jsx)(m.a,{md:12,xl:12,children:Object(A.jsxs)(b.a,{className:"Recent-Users",children:[Object(A.jsx)(b.a.Header,{children:Object(A.jsxs)(b.a.Title,{as:"h5",children:["Clients ",Object(A.jsx)(v.a,{to:"/add-client/",children:Object(A.jsx)("i",{className:"feather icon-plus-circle f-15 m-r-5"})})]})}),Object(A.jsx)(b.a.Body,{className:"px-0 py-2",children:Object(A.jsx)(O.a,{responsive:!0,hover:!0,children:Object(A.jsx)("tbody",{children:c})})})]})}),Object(A.jsx)(m.a,{md:12,xl:12,children:Object(A.jsxs)(b.a,{className:"Recent-Users justify-content-center text-center",children:[Object(A.jsx)(b.a.Header,{children:Object(A.jsxs)(p.a,{onClick:function(){return e.setState({isBlockedClientsCollapsed:!e.state.isBlockedClientsCollapsed})},children:[!this.state.isBlockedClientsCollapsed&&"View Blocked clients",this.state.isBlockedClientsCollapsed&&"Close Blocked clients"]})}),Object(A.jsx)(f.a,{in:this.state.isBlockedClientsCollapsed,children:Object(A.jsx)("div",{id:"basic-collapse",children:Object(A.jsx)(b.a.Body,{className:"px-0 py-2",children:Object(A.jsx)(O.a,{responsive:!0,hover:!0,children:Object(A.jsx)("tbody",{children:s})})})})})]})})]})})}}]),c}(x.a.Component);t.default=S},73:function(e,t,c){"use strict";var s=c(11),a=c(12),n=c(685),i="http://localhost:8000",l=function(){function e(){Object(s.a)(this,e)}return Object(a.a)(e,[{key:"get",value:function(e){return n.a.get(i+e)}},{key:"getAuth",value:function(e,t){return n.a.get(i+e,{headers:{Authorization:"Token "+t}})}},{key:"post",value:function(e,t){return n.a.post(i+e,t)}},{key:"postAuth",value:function(e,t,c){return n.a.post(i+e,t,{headers:{Authorization:"Token "+c}})}},{key:"put",value:function(e,t){return n.a.put(i+e,t)}},{key:"patchAuth",value:function(e,t,c){return n.a.patch(i+e,t,{headers:{Authorization:"Token "+c}})}},{key:"delete",value:function(e){return n.a.delete(i+e)}}]),e}();t.a=new l}}]);
//# sourceMappingURL=17.0c719989.chunk.js.map